<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Lunna Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial,sans-serif;background:#f4f4f4;}
header{background:#111;color:#fff;padding:15px;text-align:center;position:relative;}
#carrinho{position:absolute;right:20px;top:15px;background:#fff;color:#000;padding:6px 12px;border-radius:20px;cursor:pointer}
.abas{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;padding:10px;background:#222}
.abas button{background:#444;color:#fff;border:none;padding:8px 12px;border-radius:5px;cursor:pointer}
.abas button.ativo{background:#fff;color:#000;font-weight:bold}
#lista{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;padding:20px}
.card{background:#fff;border-radius:10px;padding:15px;text-align:center;box-shadow:0 2px 5px rgba(0,0,0,.2)}
.card img{width:100%;max-width:160px;margin:auto;display:block;border-radius:10px}
.card button{background:#00a859;color:#fff;border:none;padding:10px;border-radius:5px;cursor:pointer;margin-top:10px}

#modalCarrinho{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6)}
#modalConteudo{background:#fff;width:90%;max-width:500px;margin:60px auto;padding:20px;border-radius:10px}
.itemCarrinho{display:flex;gap:10px;margin-bottom:10px}
.itemCarrinho img{width:60px;border-radius:5px}
.qtd{display:flex;gap:6px;align-items:center}
.qtd button{padding:2px 8px}
.total{font-weight:bold;margin-top:10px}
.pagar{width:100%;padding:10px;background:#00a859;color:#fff;border:none;border-radius:5px;cursor:pointer}
footer{background:#111;color:#fff;text-align:center;padding:10px}
</style>
</head>

<body>

<header>
<h1>Lunna Store</h1>
<p>Semi-Joias de qualidade</p>
<div id="carrinho" onclick="verCarrinho()">ðŸ›’ <span id="qtd">0</span></div>
</header>

<nav class="abas" id="abasGenero">
<button onclick="setGenero('feminino',this)">Feminino</button>
<button onclick="setGenero('masculino',this)">Masculino</button>
<button onclick="setGenero('infantil',this)">Infantil</button>
</nav>

<nav class="abas" id="abasCategoria">
<button onclick="setCategoria('brincos',this)">Brincos</button>
<button onclick="setCategoria('braceletes',this)">Braceletes</button>
<button onclick="setCategoria('colares',this)">Colares</button>
<button onclick="setCategoria('shocker',this)">Shocker</button>
<button onclick="setCategoria('pulseiras',this)">Pulseiras</button>
<button onclick="setCategoria('tornozeleiras',this)">Tornozeleiras</button>
<button onclick="setCategoria('aneis',this)">AnÃ©is</button>
<button onclick="setCategoria('conjuntos',this)">Conjuntos</button>
<button onclick="setCategoria('pingentes',this)">Pingentes</button>
</nav>

<section id="lista"></section>

<footer>Â© 2026 - Lunna Store</footer>

<div id="modalCarrinho" onclick="fecharCarrinho(event)">
<div id="modalConteudo">
<h2>Carrinho</h2>
<div id="itensCarrinho"></div>
<div class="total" id="total"></div>
<button class="pagar" onclick="pagar()">Pagar (simulado)</button>
</div>
</div>

<script>
let genero="feminino",categoria="brincos";
let carrinho=JSON.parse(localStorage.getItem("carrinho"))||{};
let produtos=[];

function salvar(){localStorage.setItem("carrinho",JSON.stringify(carrinho));}
function atualizarQtd(){
document.getElementById("qtd").innerText=
Object.values(carrinho).reduce((s,p)=>s+p.qtd,0);
}

function ativar(btn,g){
document.querySelectorAll(g+" button").forEach(b=>b.classList.remove("ativo"));
btn.classList.add("ativo");
}

function setGenero(g,b){genero=g;ativar(b,"#abasGenero");render();}
function setCategoria(c,b){categoria=c;ativar(b,"#abasCategoria");render();}

function addCarrinho(p){
if(p.estoque<=0)return;
p.estoque--;
carrinho[p.nome]
? carrinho[p.nome].qtd++
: carrinho[p.nome]={...p,qtd:1};
salvar();atualizarQtd();render();
}

function render(){
let lista=document.getElementById("lista");
lista.innerHTML="";
produtos.forEach(p=>{
if(!p.genero.includes(genero) || p.categoria!==categoria)return;

let estoqueTxt=p.estoque>0
? `<div style="position:absolute;right:10px;bottom:10px;font-size:12px">Estoque: ${p.estoque}</div>`
: `<div style="position:absolute;right:10px;bottom:10px;font-size:12px;color:red">Sem estoque</div>`;

lista.innerHTML+=`
<div class="card ${p.genero} ${p.categoria}" style="position:relative">
<img src="${p.img}">
<h3>${p.nome}</h3>
<p>R$ ${p.preco.toFixed(2)}</p>
<button ${p.estoque<=0?"disabled style='background:#999'":""}
onclick='addCarrinho(produtos[${produtos.indexOf(p)}])'>
Adicionar
</button>
${estoqueTxt}
</div>`;
});
}

function verCarrinho(){
let h="",t=0;
Object.values(carrinho).forEach(p=>{
t+=p.preco*p.qtd;
h+=`<div class="itemCarrinho">
<img src="${p.img}">
<div>
<div>${p.nome}</div>
<div>R$ ${p.preco.toFixed(2)}</div>
<div class="qtd">
<button onclick="alterar('${p.nome}',-1)">-</button>
${p.qtd}
<button onclick="alterar('${p.nome}',1)">+</button>
</div>
</div></div>`;
});
document.getElementById("itensCarrinho").innerHTML=h||"Carrinho vazio";
document.getElementById("total").innerText="Total: R$ "+t.toFixed(2);
document.getElementById("modalCarrinho").style.display="block";
}

function alterar(n,v){
carrinho[n].qtd+=v;
if(carrinho[n].qtd<=0)delete carrinho[n];
salvar();atualizarQtd();verCarrinho();
}

function fecharCarrinho(e){
if(e.target.id==="modalCarrinho")e.target.style.display="none";
}

function pagar(){
alert("Pagamento simulado");
carrinho={};salvar();atualizarQtd();
document.getElementById("modalCarrinho").style.display="none";
}

/* CARREGA CSV */
fetch("produtos.csv")
.then(r=>r.text())
.then(t=>{
let linhas=t.trim().split("\n").slice(1);
linhas.forEach(l=>{
let [nome,preco,img,genero,categoria,estoque]=l.split(";");
produtos.push({
nome,
preco:parseFloat(preco),
img,
genero,
categoria,
estoque:parseInt(estoque)
});
});
render();atualizarQtd();
});

window.onload=()=>{
document.querySelector("#abasGenero button").classList.add("ativo");
document.querySelector("#abasCategoria button").classList.add("ativo");
};
</script>

</body>
</html>
