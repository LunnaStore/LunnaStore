<script>
let genero = "feminino";
let categoria = "brincos";

let carrinho = [];

/* FILTRO */
function atualizar(){
  document.querySelectorAll(".card").forEach(p=>{
    p.style.display =
      p.classList.contains(genero) &&
      p.classList.contains(categoria)
      ? "block" : "none";
  });
}

function ativar(botao, grupo){
  document.querySelectorAll(grupo+" button")
    .forEach(b=>b.classList.remove("ativo"));
  botao.classList.add("ativo");
}

function setGenero(g, btn){
  genero = g;
  ativar(btn, "#abasGenero");
  atualizar();
}

function setCategoria(c, btn){
  categoria = c;
  ativar(btn, "#abasCategoria");
  atualizar();
}

/* CARRINHO */
function addProduto(id, nome, preco){
  const item = carrinho.find(p => p.id === id);

  if(item){
    item.qtd++;
  } else {
    carrinho.push({ id, nome, preco, qtd:1 });
  }

  atualizarQtd();
}

function remover(id){
  carrinho = carrinho.filter(p => p.id !== id);
  renderCarrinho();
}

function diminuir(id){
  const item = carrinho.find(p => p.id === id);
  if(item.qtd > 1){
    item.qtd--;
  } else {
    remover(id);
  }
  renderCarrinho();
}

function atualizarQtd(){
  const totalItens = carrinho.reduce((s,p)=>s+p.qtd,0);
  document.getElementById("qtd").innerText = totalItens;
}

function verCarrinho(){
  renderCarrinho();
  document.getElementById("modalCarrinho").style.display = "block";
}

function fecharCarrinho(){
  document.getElementById("modalCarrinho").style.display = "none";
}

function renderCarrinho(){
  const div = document.getElementById("itensCarrinho");
  const totalSpan = document.getElementById("total");
  div.innerHTML = "";
  let total = 0;

  carrinho.forEach(p=>{
    total += p.preco * p.qtd;
    div.innerHTML += `
      <p>
        ${p.nome}<br>
        R$ ${p.preco} x ${p.qtd}
        <button onclick="addProduto(${p.id},'${p.nome}',${p.preco})">+</button>
        <button onclick="diminuir(${p.id})">-</button>
        <button onclick="remover(${p.id})">ðŸ—‘</button>
      </p>
      <hr>
    `;
  });

  totalSpan.innerText = total.toFixed(2);
}

/* PADRÃƒO */
window.onload = () => {
  document.querySelector("#abasGenero button").classList.add("ativo");
  document.querySelector("#abasCategoria button").classList.add("ativo");
  atualizar();
};
</script>
